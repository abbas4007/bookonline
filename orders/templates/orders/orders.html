{% extends 'base.html' %}
{% load humanize %}
{% load persian_tags %}  <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ -->
{% load humanize %}
{% block title %}Ù¾Ø±Ø¯Ø§Ø®Øª Ø³ÙØ§Ø±Ø´ | ÙØ±ÙˆØ´Ú¯Ø§Ù‡{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Ù‡Ø¯Ø± ØµÙØ­Ù‡ -->
            <div class="text-center mb-5">
                <div class="icon-circle bg-primary mb-3">
                    <i class="fas fa-credit-card fa-2x text-white"></i>
                </div>
                <h1 class="display-6 fw-bold text-dark mb-3">ğŸ“‹ ØªØ§ÛŒÛŒØ¯ Ùˆ Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ù‡Ø§ÛŒÛŒ</h1>
                <p class="lead text-muted">Ù„Ø·ÙØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ùˆ Ø³Ù¾Ø³ Ù¾Ø±Ø¯Ø§Ø®Øª Ø±Ø§ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯</p>
                <div class="progress mb-4" style="height: 8px;">
                    <div class="progress-bar bg-success" role="progressbar" style="width: 75%"
                         aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>

            <!-- Ú©Ø§Ø±Øª Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´ -->
            <div class="card border-0 shadow-lg mb-5">
                <div class="card-header bg-gradient-primary text-white py-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0 fw-bold"><i class="fas fa-receipt me-2"></i> Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´</h5>
                        <span class="badge bg-light text-primary fs-6">#{{ order.id }}</span>
                    </div>
                </div>
                <div class="card-body p-4">
                    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´ -->
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <div class="info-box">
                                <span class="info-label"><i class="far fa-calendar-alt me-2"></i>ØªØ§Ø±ÛŒØ® Ø³ÙØ§Ø±Ø´:</span>
                                <span class="info-value">{{ order.created|persian_datetime }}</span>
                            </div>
                        </div>
{% if order.paid %}
  <div class="alert alert-success">
    <p><strong>Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚</strong></p>
    <p>Ú©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§: <b>{{ order.tracking_code }}</b></p>
  </div>
{% else %}
  <div class="alert alert-warning">
    <p>Ø³ÙØ§Ø±Ø´ Ù‡Ù†ÙˆØ² Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
  </div>
{% endif %}
                    </div>

                    <!-- Ø¬Ø²Ø¦ÛŒØ§Øª Ù‚ÛŒÙ…Øª -->
                    <div class="price-summary bg-light rounded p-4 mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-muted">Ù…Ø¨Ù„Øº Ú©Ù„ Ø³ÙØ§Ø±Ø´:</span>
                            <span class="fw-bold">{{ order.get_items_price|intcomma }} ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-muted">ØªØ®ÙÛŒÙ:</span>
                            <span class="text-success fw-bold">{{ order.get_discount_amount|intcomma }} ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-muted">Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø±Ø³Ø§Ù„:</span>
                            <span class="fw-bold">{{ order.get_shipping_cost|intcomma }}</span>
                        </div>
                        <hr class="my-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fs-5 fw-bold">Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª:</span>
                            <span class="display-6 fw-bold text-success">
                                {{ order.get_final_price|intcomma }} <small class="fs-6">ØªÙˆÙ…Ø§Ù†</small>
                            </span>
                        </div>
                    </div>

                    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù‚Ø¯Ø§Ù… -->
                    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-center gap-3 mt-4">
                        <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª -->
                        <a href="{% url 'orders:cart' %}" class="btn btn-outline-secondary btn-lg px-5">
                            <i class="fas fa-arrow-right me-2"></i>
                            Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯
                        </a>

                        <!-- Ø¯Ú©Ù…Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø§ØµÙ„ÛŒ -->
                        <a href="{% url 'orders:order_pay' order.id %}"
                           class="btn btn-success btn-lg px-5 py-3 shadow-hover">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-lock me-3 fs-4"></i>
                                <div class="text-start">
                                    <div class="fw-bold fs-5">Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ù…Ù†</div>
                                    <small class="opacity-75">Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ø¨Ø§Ù†Ú©ÛŒ</small>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ -->
            <div class="alert alert-info border-0 shadow-sm">
                <div class="d-flex">
                    <i class="fas fa-shield-alt fa-2x text-info me-3"></i>
                    <div class =''>
                        <h6 class="alert-heading mb-2 " >ğŸ’³ Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ù…Ù† Ùˆ Ù…Ø·Ù…Ø¦Ù†</h6>
                        <p class="mb-2">ØªÙ…Ø§Ù… ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø¯Ø±Ú¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù† Ø¨Ø§Ù†Ú©ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Øª Ø´Ù…Ø§ Ù†Ø²Ø¯ Ø¨Ø§Ù†Ú© Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.</p>
                        <div class="d-flex align-items-center mt-2">
                            <img src="https://img.icons8.com/color/30/000000/verified-account.png" alt="Ø§Ù…Ù†" class="me-2">
                            <small class="text-muted">Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ù…Ø§ ØªÙˆØ³Ø· Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø§Ù†Ú© Ù…Ø­Ø§ÙØ¸Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ -->
<style>
    .icon-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .bg-gradient-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .price-summary {
        border-right: 4px solid #28a745;
        background-color: #f8f9fa;
    }

    .info-box {
        background: white;
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #e9ecef;
        transition: all 0.3s ease;
    }

    .info-box:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .info-label {
        display: block;
        color: #6c757d;
        font-size: 0.9rem;
        margin-bottom: 5px;
    }

    .info-value {
        display: block;
        color: #343a40;
        font-size: 1.1rem;
        font-weight: 600;
    }

    .shadow-hover {
        transition: all 0.3s ease;
    }

    .shadow-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3) !important;
    }

    .btn-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        border: none;
        min-width: 250px;
    }

    .progress {
        max-width: 300px;
        margin: 0 auto;
        border-radius: 10px;
    }

    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª */
    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
        100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
    }

    .btn-success {
        animation: pulse 2s infinite;
    }
</style>

<!-- Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø±Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ Ù¾Ø±Ø¯Ø§Ø®Øª -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ£ÛŒÛŒØ¯ Ù‚Ø¨Ù„ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª
        const payButton = document.querySelector('a[href*="order_pay"]');
        if(payButton) {
            payButton.addEventListener('click', function(e) {
                if(!confirm('Ø¢ÛŒØ§ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                    e.preventDefault();
                }
            });
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾ÛŒØ´Ø±ÙØª
        const progressBar = document.querySelector('.progress-bar');
        let width = 75;
        const interval = setInterval(() => {
            if(width < 85) {
                width++;
                progressBar.style.width = width + '%';
            } else {
                clearInterval(interval);
            }
        }, 100);
    });
</script>
{% endblock %}